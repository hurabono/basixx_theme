<style>
  .modal{
    padding: 20px 40px;
    position: fixed;
    left: 0;
    top: 0;
    border-radius: 5px;
    z-index: 999;
  }
</style>

<div class="relative flex flex-col">
  {% assign link_handle = section.id | replace: '-', '_' %}

 <div class="flex justify-end">
<div class="relative top-[50px] right-[10px] flex justify-end z-10 bg-white rounded-full p-2">
        {%- render 'button-trash', product: product -%}
  </div>

</div>
  <a href="{{ product.url | within: collection }}" class="block group block relative">
    <img sizes="(min-width: 768px) 450px,630px"
          srcset="{{ product.featured_image.src | img_url: '450x' }} 450w,
                  {{ product.featured_image.src | img_url: '630x' }} 630w" 
                  src="{{ product.featured_image.src | img_url: '630x' }}" 
                  alt="{{ product.featured_image.alt | escape }}" 
                  loading="lazy" 
                  class="w-full object-cover object-center rounded-md">
    {% if product.price < product.compare_at_price %}
      <div class="text-sm tracking-wider uppercase absolute top-[11px] left-[-11px] px-[1rem] py-1" style="background: {{product_badge_color}}; color:{{product_title_color}};">
        {{ 'common.sale' | t }}
      </div>
    {% endif %}
  </a>

  <div class="{{product_title}} mt-4 text-center" style="color: {{product_title_color}};">

    {% if vendor_set == true %}
      <a href="{{ product.url | within: collection }}" class="block text-xs">
        {{ product.vendor }}
      </a>
    {% endif %}



    <div class="flex flex-col sm:flex-row justify-between">
    {% if product.title %}
      <div>
        <a href="{{ product.url | within: collection }}" class="font-bold" style="font-size: {{product_font_size}}rem;">
        {{ product.title | strip_html | truncate: 20}}
        </a>
      </div>
      
    {% endif %}

    {%- if show_rating -%}
    {% liquid
      assign rating_decimal = 0
      assign decimal = product.metafields.reviews.rating.value.rating | modulo: 1
      if decimal >= 0.3 and decimal <= 0.7
        assign rating_decimal = 0.5
      elsif decimal > 0.7
        assign rating_decimal = 1
      endif
    %}
      <div>
        {% if product.metafields.reviews.rating_count > 0 %}
        <div class="rating" role="img" aria-label="{{ 'star review' | t: rating_value: product.metafields.reviews.rating.value, rating_max: product.metafields.reviews.rating.value.scale_max }}">
          <span class="no-rating" >
           {{ product.metafields.reviews.rating.value.rating | floor }}
           </span>
        </div>
  
          {%else%}
          <div class="rating" role="img" aria-label="{{ 'star review' | t: rating_value: product.metafields.reviews.rating.value, rating_max: product.metafields.reviews.rating.value.scale_max }}">
            <span aria-hidden="true" class="no-rating" 
            style="--rating: {{ product.metafields.reviews.rating.value.rating | floor }};
             --rating-max: {{ product.metafields.reviews.rating.value.scale_max }}; 
             --rating-decimal: {{ rating_decimal }};">
             0
             </span>
          </div>
        {% endif %}
      </div>
    {%endif%}
    </div>

    {%- comment -%} line 2 - Metafield option box {%- endcomment -%}
    <div class="relative">
      
        <ul class="flex justify-between gap-[0.5rem] py-2">

            {%- if product.metafields.custom.symbol_first.value != blank -%}
            <li class="metafield_icons text-xs tracking-wider flex flex-col w-full md:flex-row justify-evenly items-center rounded-sm py-1"
            >
                <span class="slider_symbol p-1 md:p-0">{{iconbox1}}  </span>
                <span class="slider_symbol p-1 md:p-0"> {{ product.metafields.custom.symbol_first.value }} </span>
            </li>
            {%- endif -%}

            {%- if product.metafields.custom.symbol_second.value != blank -%}
            <li class="metafield_icons text-xs tracking-wider flex flex-col w-full md:flex-row justify-evenly items-center rounded-sm py-1"
            >
                <span class="slider_symbol p-1 md:p-0"> {{iconbox2}} </span>
                <span class="slider_symbol p-1 md:p-0">  {{ product.metafields.custom.symbol_second.value }}</span>
            </li>
            {%- endif -%}

            {%- if product.metafields.custom.symbol_third.value != blank -%}
            <li class="metafield_icons text-xs tracking-wider flex flex-col w-full md:flex-row justify-evenly items-center rounded-sm py-1"
            >
               <span class="slider_symbol p-1 md:p-0"> {{iconbox3}}</span> 
            <span class="slider_symbol p-1 md:p-0">  {{ product.metafields.custom.symbol_third.value }}  </span>
            </li>
            {%- endif -%}
        </ul>
    </div>
    {%- comment -%} line 2 - end {%- endcomment -%}


    {% if product.available %}
        <div class="flex justify-between items-center py-2">
        
        {% if product.metafields.custom.custom_price.value != blank or product.price == 0%}
          <span class="text-lg font-bold" {% if product.compare_at_price %} style="color: {{product_title_color}};" {% endif %}>
          {{ product.metafields.custom.custom_price.value }}
          </span>
        {%- else -%}
            <span class="text-lg" {% if product.compare_at_price %} style="color: {{product_point_color}};" {% endif %}>
            {{ product.price | money }}
          </span>

          {% if product.compare_at_price %}
            <del class="ml-2 text-sm">
              {{ product.compare_at_price | money }}
            </del>
          {% endif %}
        {%- endif -%}

        {%- if product.metafields.custom.promotion.value != blank -%}
          <span class="px-2 py-1 metafield_symbol text-xs">
          {{ product.metafields.custom.promotion.value }}
        </span>
        {%- endif -%}
        
      </div>
       {% else %}
      <div>
        {{ 'common.sold_out' | t }}
      </div>
    {% endif %}
  </div>
</div> 